(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a1ecb38"],{"09c4":function(t,a,s){"use strict";s.r(a);var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("main",[t.carts.length?t._e():s("section",{staticClass:"row justify-content-center mt-5"},[s("div",{staticClass:"col text-center"},[s("i",{staticClass:"fas fa-5x fa-shopping-cart text-secondary mb-4"}),s("div",{staticClass:"h5 font-weight-bold"},[t._v("你的購物車是空的")]),s("div",{staticClass:"u-fz-sm mb-3"},[t._v("記得加入商品到你的購物車")]),s("router-link",{staticClass:"btn btn-info px-4",attrs:{to:"/products"}},[t._v("前往購物")])],1)]),s("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(a){var e=a.handleSubmit;return[t.carts.length?s("form",{staticClass:"row mt-sm-4 mt-3",on:{submit:function(a){return a.preventDefault(),e(t.goCheckout)}}},[s("section",{staticClass:"col-lg-8 mb-3"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header px-sm-3 px-2"},[s("h3",{staticClass:"font-weight-bold card-title h5 mb-0"},[t._v("購物車（"+t._s(t.carts.length)+" 件）")])]),s("div",{staticClass:"p-checkout__grid d-none d-sm-grid u-fz-sm"},[s("div",{staticClass:"p-checkout__grid__title"},[t._v("商品資料")]),s("div",{staticClass:"p-checkout__grid__price"},[t._v("單件價格")]),s("div",{staticClass:"p-checkout__grid__qty text-center"},[t._v("數量")]),s("div",{staticClass:"p-checkout__grid__total text-center"},[t._v("小計")]),s("div",{staticClass:"p-checkout__grid__btn"})]),t._l(t.carts,(function(a,e){return s("div",{key:a.id,staticClass:"p-checkout__grid",class:{"border-bottom-0":e+1===t.carts.length}},[s("div",{staticClass:"p-checkout__grid__title"},[s("div",{staticClass:"p-cart__img",style:{"background-image":"url("+a.imageUrl+")"}}),s("h5",{staticClass:"h6"},[t._v(t._s(a.title))])]),s("div",{staticClass:"p-checkout__grid__price"},[s("span",[t._v("NT"+t._s(t._f("currency")(a.price)))]),s("br"),a.price!==a.origin_price?s("del",{staticClass:"u-fz-sm text-muted"},[t._v(" NT"+t._s(t._f("currency")(a.origin_price))+" ")]):t._e()]),s("div",{staticClass:"p-checkout__grid__qty"},[s("QtyButton",{attrs:{data:a,qtyClass:["input-group-sm","pr-sm-1"],isId:!1}})],1),s("div",{staticClass:"p-checkout__grid__total"},[t._v(" NT"+t._s(t._f("currency")(a.qty*a.price))+" ")]),s("div",{staticClass:"p-checkout__grid__btn"},[s("button",{staticClass:"close float-none",attrs:{type:"button","aria-label":"Close"},on:{click:function(s){return t.showDelModal(a)}}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])])}))],2)]),s("section",{staticClass:"col-lg-4"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header px-sm-3 px-2"},[s("h3",{staticClass:"font-weight-bold card-title h5 mb-0"},[t._v("訂單資訊")])]),s("div",{staticClass:"card-body"},[s("div",{staticClass:"d-flex justify-content-between mb-2"},[s("span",[t._v("小計：")]),s("span",[t._v("NT"+t._s(t._f("currency")(t.getTotal)))])]),s("div",{staticClass:"d-flex justify-content-between mb-2"},[s("span",[t._v("運費：")]),s("span",[t._v("NT$0")])]),s("hr"),s("b",{staticClass:"d-flex justify-content-between mb-3",class:{"text-success":t.carts.final_total!==t.carts.total}},[s("span",[t._v("合計：")]),s("span",[t._v("NT"+t._s(t._f("currency")(t.getTotal)))])]),s("div",{staticClass:"d-flex"},[s("router-link",{staticClass:"btn btn-outline-info btn-block mr-2 text-dark",attrs:{to:"/products"}},[t._v("繼續購物")]),s("button",{staticClass:"btn btn-info btn-block mt-0",class:{disabled:t.status.goCheckoutLoading},attrs:{type:"submit"}},[t._v(" 前往結帳 "),t.status.goCheckoutLoading?s("i",{staticClass:"fas fa-spinner fa-spin ml-1"}):t._e()])],1)])])])]):t._e()]}}])}),s("div",{staticClass:"modal fade",attrs:{id:"delModal",tabindex:"-1","aria-labelledby":"delModalLabel","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog modal-dialog-centered"},[s("div",{staticClass:"modal-content"},[t._m(0),s("div",{staticClass:"modal-body text-center"},[t._v(" 確定要移除 "),s("b",[t._v(t._s(t.newCart.title))]),t._v(" 這個商品嗎？ ")]),s("div",{staticClass:"modal-footer border-0 pt-4"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),s("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(a){return t.removeCart()}}},[t._v("確定")])])])])])],1)},i=[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"modal-header border-0 pt-2 pb-4"},[s("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],c=s("5530"),n=(s("99af"),s("159b"),s("13d5"),s("1157")),r=s.n(n),o=s("2f62"),l=s("88ba"),d={name:"CheckoutCart",data:function(){return{status:{goCheckoutLoading:!1},total:0,newCart:{}}},methods:{showDelModal:function(t){this.newCart=t,r()("#delModal").modal("show")},removeCart:function(){r()("#delModal").modal("hide"),this.$store.dispatch("cartModules/removeCart",this.newCart.id)},goCheckout:function(){var t=this,a="".concat("https://vue-course-api.hexschool.io/","api/").concat("chin","/cart"),s=[],e=[],i=[],c=JSON.parse(localStorage.getItem("carts"));t.status.goCheckoutLoading=!0,t.$http.get(a).then((function(t){return t.data.data.carts})).then((function(s){if(s.length)return s.forEach((function(s){var i=t.$http.delete("".concat(a,"/").concat(s.id));e.push(i)})),t.$http.all(e)})).then((function(){return c.forEach((function(t){s.push({product_id:t.id,qty:t.qty})})),s.forEach((function(s){var e=t.$http.post(a,{data:s});i.push(e)})),t.$http.all(i)})).then((function(){t.status.goCheckoutLoading=!1,t.$router.push("/checkout/info")}))}},computed:Object(c["a"])({getTotal:function(){return this.carts.reduce((function(t,a){var s=t+a.qty*a.price;return s}),0)}},Object(o["c"])("cartModules",["carts"])),components:{QtyButton:l["a"]}},u=d,_=s("2877"),h=Object(_["a"])(u,e,i,!1,null,null,null);a["default"]=h.exports},"13d5":function(t,a,s){"use strict";var e=s("23e7"),i=s("d58f").left,c=s("a640"),n=s("2d00"),r=s("605d"),o=c("reduce"),l=!r&&n>79&&n<83;e({target:"Array",proto:!0,forced:!o||l},{reduce:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},d58f:function(t,a,s){var e=s("1c0b"),i=s("7b0b"),c=s("44ad"),n=s("50c4"),r=function(t){return function(a,s,r,o){e(s);var l=i(a),d=c(l),u=n(l.length),_=t?u-1:0,h=t?-1:1;if(r<2)while(1){if(_ in d){o=d[_],_+=h;break}if(_+=h,t?_<0:u<=_)throw TypeError("Reduce of empty array with no initial value")}for(;t?_>=0:u>_;_+=h)_ in d&&(o=s(o,d[_],_,l));return o}};t.exports={left:r(!1),right:r(!0)}}}]);
//# sourceMappingURL=chunk-3a1ecb38.2075dee4.js.map